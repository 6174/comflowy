import { Steps, Callout, Tabs } from 'nextra-theme-docs';
import { PhotoProvider, PhotoView } from 'react-image-previewer';
import Subscribe from "components/subscribtion";

# 下载 & 导入模型

安装完 ComfyUI 后，你需要下载对应的模型，并将对应的模型导入到对应的文件夹内。在讲解如何下载模型之前，我们先来简单了解一下 Stable Diffusion 的不同版本之间的差别，你可以根据你自己的需求下载一个合适的版本。

## 不同 Stable Diffusion 的差别

<Callout type="info">
  在后续的教程中，我会介绍更多模型相关的介绍。
</Callout>

### Stable Diffusion v1.5
- 这是 Stable Diffusion 的的早期版本，目前市场上的很多 Lora 模型以及 ContrlNet 模型都是基于它来构建的，所以在开始使用 ComfyUI 的时候为了少踩坑，建议围绕 1.5 版本进行学习。
- 模型官方介绍：[Stable Diffusion v1.x press release](https://stability.ai/blog/stable-diffusion-public-release)

### Stable Diffusion v2.0
- 这是 Stable Diffusion 的一个重大更新，相比于 v1.5 版本，它在图像生成质量和速度上都有所提升。
- 2.0 版本采用了新的文本编码器 OpenCLIP，可以更好地理解文本提示，从而生成更高质量的图像。此外，2.0 版本还支持更高的图像分辨率，可以生成默认分辨率为 512x512 像素和 768x768 像素的图像。
- 模型官方介绍：[Stable Diffusion v2 press release](https://stability.ai/blog/stable-diffusion-v2-release)

### Stable Diffusion XL
- 这是 Stable Diffusion 的最新版本，它在 2.0 版本的基础上进行了进一步的优化和改进。
- XL 版本的主要特点是其更大的模型大小，从 0.98B 扩大到 6.6B 参数，这使得它能够生成更高质量的图像。
- XL 版本还引入了新的功能，如更有艺术感的图像，更真实的图像，以及更清晰可读的字体等。
- 模型官方介绍：[Stable Diffusion xl 1.0 press release](https://stability.ai/news/stable-diffusion-sdxl-1-announcement)

<Subscribe />

## 模型下载 

我常用的下载渠道有两个，一个是 HuggingFace，最后一个是 CivitAI 站点。

### HuggingFace

你可以将 HuggingFace 理解为 AI 届的 Github。上面会有不少人或组织会将他们的模型分享到上面。你可以通过 HuggingFace 的搜索功能来搜索你想要的模型：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/009.jpg">
      <img src="/install-comfyui-and-model/009.jpg" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

比如我们搜索 Stable Diffusion v1.5，你会看到这样的页面，然后我们点击页面里的 Files and versions 按钮（图中 1），接着你会看到很多文件，此时你需要选择你需要下载的模型文件，然后点击下载按钮（图中 2）：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/010.png">
      <img src="/install-comfyui-and-model/010.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

一般你会看到两种后缀的模型：

- **safetensors**：这种模型一般用的是 numpy 格式保存，这就意味着它只保存了张量数据，没有任何代码，加载这类文件会更安全和更快。
- **ckpt**：这种文件是序列化过的，这意味着它们可能会包含一些恶意代码，加载这类模型就可能会带来安全风险。

所以在上述的案例中，我会推荐你下载 safetensors 格式的模型。

另外，我建议你在搜索模型的时候，需要看看是不是该模型的官方发的，一般我会看模型的下载数，一般下载数越多的模型，越有可能是官方发的。

### CivitAI

与 HuggingFace 不同，CivitAI 站点更偏向于 UGC 一些，所以你会看到更多个人训练的模型，但是这并不意味着它们的质量会差，相反，你会发现有些模型的质量非常好。

而且 CivitAI 比 HuggingFace 多了很多好用的功能，比如你可以通过筛选等方式，看到各种各样优秀的模型：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/011.jpg">
      <img src="/install-comfyui-and-model/011.jpg" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

同样的，你也可以通过 CivitAI 的搜索功能来搜索你想要的模型，并下载该模型，以 DreamShaper 为例，你只要点击下载按钮（图中 1）即可下载模型：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/012.jpg">
      <img src="/install-comfyui-and-model/012.jpg" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

<Callout type="warning" emoji="⚠️">
  在后续的教程中，我会使用到各种模型，你都可以根据自己的需求在以上两个渠道下载不同的模型。但现在我建议你先在 HuggingFace 上下载 Stable Diffusion v1.5 和 Stable Diffusion XL 模型，前者有很多配套的模型，而后者的出图效果相对比较好，不少最新的模型也都有基于它去优化。
</Callout>

## 模型导入

模型下载好后，我们要将对应的模型放到 ComfyUI 的 models 目录下。

<Steps>
  ### 打开 ComfyUI 项目文件夹
  你可以使用上一章提到的 Github Desktop，打开 ComfyUI 项目的文件夹。在 Github Desktop 上点击「Show in Finder」按钮，如果是 Win 则是「Show in Explorer」按钮。即可打开该项目的文件夹。然后你需要点击进入到 models 目录下：
  <PhotoProvider>
    <PhotoView src="/install-comfyui-and-model/013.png">
        <img src="/install-comfyui-and-model/013.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
    </PhotoView>
  </PhotoProvider>

  ### 将模型添加到对应的文件夹
  进入到 Model 文件夹后，你会看到很多个文件夹，这些文件夹分别对应着不同的模型，你需要将你下载的模型放到对应的文件夹下。比如我们刚刚下载的是 Stable Diffusion v1.5 模型，属于 checkpoints 就需要将该模型放到 checkpoints 文件夹下。后续我们会介绍不同的类型的模型，你需要将其放到对应的文件夹里，比如后面会介绍的 LoRA 模型就要放到 loras 文件夹下。
  <PhotoProvider>
    <PhotoView src="/install-comfyui-and-model/014.png">
        <img src="/install-comfyui-and-model/014.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
    </PhotoView>
  </PhotoProvider>
</Steps>


🎉 恭喜你，又完成了一个重要的步骤，接下来我们就可以正式进入 ComfyUI 基础篇的学习了。

<Subscribe />
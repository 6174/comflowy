import { Steps, Callout, Tabs } from 'nextra-theme-docs';
import { PhotoProvider, PhotoView } from 'react-image-previewer';
import Subscribe from "components/subscribtion";

# 安装插件（选修）

安装完模型后，你其实就可以进入下一个章节的学习，但我还想推荐一个叫 ComfyUI Manager 的小工具，这个工具可以提升使用 ComfyUI 的效率。

如果你对技术比较熟悉，可以直接查看 ComfyUI Manager 的[官方文档](https://github.com/ltdrdata/ComfyUI-Manager)。

## 安装 ComfyUI Manager

安装方法两种，如果你之前使用的 VS Code 安装 ComfyUI 我会推荐你使用这个方式，使用 VS Code 安装相对比较简单。

<Steps>
  ### 使用 VS Code / Terminal 打开 ComfyUI 项目
  <Tabs items={['VS Code', 'Terminal']}>
    <Tabs.Tab>
      如果你有安装 Github Desktop，那你可以直接在应用里点击「Open in Visual Studio Code」按钮。如果没有则找到 ComfyUI 项目文件夹，然后将整个文件夹拖到 VS Code 里。
    </Tabs.Tab>
    <Tabs.Tab>
      打开 Terminal 输入 cd，然后空格，接着黏贴 ComfyUI 的项目文件夹地址（如果你不知道如何找到这个地址，请查阅 [安装 ComfyUI](./install.mdx) 一章中的第三步）。
    </Tabs.Tab>
  </Tabs>
  ### 输入命令
  如果你用的是 VS Code 则点击 VS Code 右上角的第二个 icon，然后你会在软件底部看到一个类似你之前在 Terminal 里看到的命令输入界面。此时输入以下命令，并回车。如果你使用的是 Terminal，就直接输入以下命令：
  ```shell copy
  cd custom_nodes
  ```
  然后再输入：
  ```shell copy
  git clone https://github.com/ltdrdata/ComfyUI-Manager.git
  ```
  ### 启动 ComfyUI
  此时需要启动 ComfyUI，需要注意你不能直接输入启动的命令，而是要先将 Terminal cd 到上一个目录（即 ComfyUI 的目录）。
  <Tabs items={['VS Code', 'Terminal']}>
    <Tabs.Tab>
      最简单的方法就是点击 VS Code 里 Terminal 右上角的小垃圾桶。然后再点一下右上角的第二个 icon 此时就回到了 ComfyUI 的目录。
      <br/>
      <PhotoProvider>
        <PhotoView src="/install-comfyui-and-model/015.png">
            <img src="/install-comfyui-and-model/015.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
        </PhotoView>
      </PhotoProvider>
    </Tabs.Tab>
    <Tabs.Tab>
      这个也很简单，你需要点击按一下键盘的上方向键，输入框里就会出现你上一步输入的命令，此时你需要回退到最开始的那一步。
      最后输入以下命令，启动 ComfyUI:
      ```shell copy
      python main.py --force-fp16 
      ```
      启动 ComfyUI 后，你应该你能看到右侧的面板多了两个按钮，Manager 和 Share，那证明你已经安装完成。
      <br/>
      <PhotoProvider>
        <PhotoView src="/install-comfyui-and-model/016.png">
            <img src="/install-comfyui-and-model/016.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
        </PhotoView>
      </PhotoProvider>
    </Tabs.Tab>
  </Tabs>

  ### 意外
  但有可能你完成启动后，并没有看到 ComfyUI Manager 的面板，同时你会在 Terminal 里看到类似这样的内容：
  ```shell
  Cannot import /Users/jimmywang/Documents/GitHub/ComfyUI/custom_nodes/ComfyUI-Manager module for custom nodes: No module named 'torchvision'
  ```
  这意味着你需要安装 torchvision，你需要先关闭 ComfyUI 的服务（在 Terminal 面板里点击 Ctrl+C），然后在 Terminal 里输入：
  ```shell copy
  pip install torchvision
  ```
  安装完后，再启动一下 ComfyUI。
</Steps>

## 功能介绍
插件我比较常用的有两个功能，其余功能，我会在后续的章节中给大家介绍。

### 下载模型
首先点击右侧面板上的 Manager 按钮，会弹出这样的一个框，接着我们再点击中间的「Install Models」按钮：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/017.png">
      <img src="/install-comfyui-and-model/017.png" alt="" width="80%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>
然后会弹出这样的弹窗。第一列是代表这个模型用在什么类型的节点，你可以根据自己的需求点击右边的 Install 按钮，进行下载安装。下载好后，插件会自动将模型放到对应的文件夹内，不需要你手动移动。
但需要注意，下载的时候，无法出图。
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/018.png">
      <img src="/install-comfyui-and-model/018.png" alt="" width="70%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

### 补全 nodes
ComfyUI 右侧的面板中有个 Load 按钮，点击该按钮，可以将别人制作好的 workflow 导入到 ComfyUI 里，但有的时候，你导入的 workflow 用了一些你没有安装过的插件。此时 ComfyUI 就会弹出提示告知没有安装某些节点。

此时就可以用到 ComfyUI Manager 的另一个常用功能是 Install Missing Custom Nodes。

点击该功能后，插件会自动搜索你没有安装的节点，然后加载一个列表，点击列表右侧的安装即可完成安装。当然你可以点击 ComfyUI Manager 菜单里的 Install Custom Nodes 自己搜索安装，安装后还能将其禁用 Disable，或者卸载 Unistall：
<br/>
<PhotoProvider>
  <PhotoView src="/install-comfyui-and-model/019.png">
      <img src="/install-comfyui-and-model/019.png" alt="" width="70%" style={{ display: "block", margin: "0 auto" }}/>
  </PhotoView>
</PhotoProvider>

最后，如果使用上述插件的功能，你还是补全缺失的节点，你还可以在 Github 上搜索对应的节点，看看能否找到。

<Subscribe />